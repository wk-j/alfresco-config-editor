<html>

<head>
	<title>Empty</title>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/codemirror.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/theme/seti.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.css">

	<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/codemirror.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/mode/javascript/javascript.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/mode/xml/xml.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/mode/css/css.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/mode/elm/elm.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/mode/htmlmixed/htmlmixed.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/mode/properties/properties.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.29.0/mode/markdown/markdown.js"></script>

	<link rel="stylesheet" href="Style.css">
</head>

<body>

	<script src="dist/Main.js"></script>

	<div class="ui grid">
			<div class="row">
				<div class="ten wide column">
					<div class="ui raised segment" style="width:100%; padding:0">
						<div id="code-editor"></div>
					</div>
				</div>
				<div class="six wide column">
					<div class="ui segment" style="height: 100%">
						<div id="tree-view"></div>
					</div>
				</div>
			</div>
	</div>

	<script>
		let editor = CodeMirror(document.getElementById("code-editor"), {
			mode: "javascript",
			theme: "seti",
			lineNumbers: true,
			tabSize: 2
		});

		let container = document.getElementById("tree-view");
		let app = Elm.Main.embed(container);

		app.ports.setEditorContent.subscribe((x) => {
			let content = x.content;
			let mode = x.mode; 

			editor.setValue(content);
			editor.setOption("mode", mode);
		});

		// on and off handler like in jQuery
		editor.on('change', function(cMirror){
			let value = cMirror.getValue();
			app.ports.receiveEditorContent.send(value);
		});

	</script>
</body>

</html>